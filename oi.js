(()=>{let A;(()=>{const e="__app_hrp",t="production",i=!1;if(A=globalThis[e],A)return;const r={name:e,env:t,get:A=>A in r?r[A]:null,...JSON.parse('{"version":"11.4.0"}')},s=function A(e){const t=e===r,s=t&&i,a={},c=A=>Object.assign(e,A),h=new Proxy(e,{get(i,r){if("assign"===r)return c;if(t&&!String(r).startsWith("$"))return e[r];if(!(r in e)){if(e[r]={},t){const A=n.bind(null,"log",r,!1),t=n.bind(null,"log",r,!0),i=n.bind(null,"warn",r,!1),s=n.bind(null,"warn",r,!0),a=n.bind(null,"error",r,!1),c=n.bind(null,"error",r,!0),h=o.bind(null,r);Object.defineProperties(e[r],{log:{get:()=>A},logDev:{get:()=>t},warn:{get:()=>i},warnDev:{get:()=>s},error:{get:()=>a},errorDev:{get:()=>c},Error:{get:()=>h}})}a[r]=A(e[r]),s&&(globalThis[r]=e[r])}return r in a?a[r]:e[r]},set:(A,t,i)=>(e[t]=i,a[t]=i,s&&(globalThis[t]=e[t]),!0)});return h}(r);function n(A,e,t,...i){if(t)return;const[r,s,n]=function(A){let e=0;A.split("").forEach(((t,i)=>{e=A.charCodeAt(i)+((e<<5)-e)}));return[(16711680&e)>>16,(65280&e)>>8,255&e]}(e);console[A](`%c[${e}]`,`color: rgb(${r}, ${s}, ${n})`,...i)}function o(A,e,...t){return t.length>0&&n("error",A,!1,e,...t),new Error(`[${A}] ${e}`)}globalThis[e]=s,A=s})(),(()=>{function e(A,e,t,i){return new(t||(t=Promise))((function(r,s){function n(A){try{a(i.next(A))}catch(A){s(A)}}function o(A){try{a(i.throw(A))}catch(A){s(A)}}function a(A){var e;A.done?r(A.value):(e=A.value,e instanceof t?e:new t((function(A){A(e)}))).then(n,o)}a((i=i.apply(A,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var t,i=class{constructor(){this.mutex=Promise.resolve()}lock(){let A=()=>{};return this.mutex=this.mutex.then((()=>new Promise(A))),new Promise((e=>{A=e}))}dispatch(A){return e(this,void 0,void 0,(function*(){const e=yield this.lock();try{return yield Promise.resolve(A())}finally{e()}}))}},r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,s=null!==(t=r.Buffer)&&void 0!==t?t:null,n=r.TextEncoder?new r.TextEncoder:null;function o(A,e){return(15&A)+(A>>6|A>>3&8)<<4|(15&e)+(e>>6|e>>3&8)}var a="a".charCodeAt(0)-10,c="0".charCodeAt(0);function h(A,e,t){let i=0;for(let r=0;r<t;r++){let t=e[r]>>>4;A[i++]=t>9?t+a:t+c,t=15&e[r],A[i++]=t>9?t+a:t+c}return String.fromCharCode.apply(null,A)}var l=null!==s?A=>{if("string"==typeof A){const e=s.from(A,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.length)}if(s.isBuffer(A))return new Uint8Array(A.buffer,A.byteOffset,A.length);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")}:A=>{if("string"==typeof A)return n.encode(A);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=new Uint8Array(256);for(let A=0;A<I.length;A++)g[I.charCodeAt(A)]=A;function B(A){const e=function(A){let e=Math.floor(.75*A.length);const t=A.length;return"="===A[t-1]&&(e-=1,"="===A[t-2]&&(e-=1)),e}(A),t=A.length,i=new Uint8Array(e);let r=0;for(let e=0;e<t;e+=4){const t=g[A.charCodeAt(e)],s=g[A.charCodeAt(e+1)],n=g[A.charCodeAt(e+2)],o=g[A.charCodeAt(e+3)];i[r]=t<<2|s>>4,r+=1,i[r]=(15&s)<<4|n>>2,r+=1,i[r]=(3&n)<<6|63&o,r+=1}return i}var u=16384,Q=new i,w=new Map;function C(A,t){return e(this,void 0,void 0,(function*(){let i=null,r=null,s=!1;if("undefined"==typeof WebAssembly)throw new Error("WebAssembly is not supported in this environment!");const n=()=>new DataView(i.exports.memory.buffer).getUint32(i.exports.STATE_SIZE,!0),a=Q.dispatch((()=>e(this,void 0,void 0,(function*(){if(!w.has(A.name)){const e=B(A.data),t=WebAssembly.compile(e);w.set(A.name,t)}const e=yield w.get(A.name);i=yield WebAssembly.instantiate(e,{})})))),c=(A=null)=>{s=!0,i.exports.Hash_Init(A)},I=A=>{if(!s)throw new Error("update() called before init()");(A=>{let e=0;for(;e<A.length;){const t=A.subarray(e,e+u);e+=t.length,r.set(t),i.exports.Hash_Update(t.length)}})(l(A))},g=new Uint8Array(2*t),C=(A,e=null)=>{if(!s)throw new Error("digest() called before init()");return s=!1,i.exports.Hash_Final(e),"binary"===A?r.slice(0,t):h(g,r,t)},E=A=>"string"==typeof A?A.length<4096:A.byteLength<u;let f=E;switch(A.name){case"argon2":case"scrypt":f=()=>!0;break;case"blake2b":case"blake2s":f=(A,e)=>e<=512&&E(A);break;case"blake3":f=(A,e)=>0===e&&E(A);break;case"xxhash64":case"xxhash3":case"xxhash128":f=()=>!1}return yield(()=>e(this,void 0,void 0,(function*(){i||(yield a);const A=i.exports.Hash_GetBuffer(),e=i.exports.memory.buffer;r=new Uint8Array(e,A,u)})))(),{getMemory:()=>r,writeMemory:(A,e=0)=>{r.set(A,e)},getExports:()=>i.exports,setMemorySize:A=>{i.exports.Hash_SetMemorySize(A);const e=i.exports.Hash_GetBuffer(),t=i.exports.memory.buffer;r=new Uint8Array(t,e,A)},init:c,update:I,digest:C,save:()=>{if(!s)throw new Error("save() can only be called after init() and before digest()");const e=i.exports.Hash_GetState(),t=n(),r=i.exports.memory.buffer,a=new Uint8Array(r,e,t),c=new Uint8Array(4+t);return function(A,e){const t=e.length>>1;for(let i=0;i<t;i++){const t=i<<1;A[i]=o(e.charCodeAt(t),e.charCodeAt(t+1))}}(c,A.hash),c.set(a,4),c},load:e=>{if(!(e instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");const t=i.exports.Hash_GetState(),r=n(),a=4+r,c=i.exports.memory.buffer;if(e.length!==a)throw new Error(`Bad state length (expected ${a} bytes, got ${e.length})`);if(!function(A,e){if(A.length!==2*e.length)return!1;for(let t=0;t<e.length;t++){const i=t<<1;if(e[t]!==o(A.charCodeAt(i),A.charCodeAt(i+1)))return!1}return!0}(A.hash,e.subarray(0,4)))throw new Error("This state was written by an incompatible hash implementation");const h=e.subarray(4);new Uint8Array(c,t,r).set(h),s=!0},calculate:(A,e=null,s=null)=>{if(!f(A,e))return c(e),I(A),C("hex",s);const n=l(A);return r.set(n),i.exports.Hash_Calculate(n.length,e,s),h(g,r,t)},hashLength:t}}))}new i,new i,new DataView(new ArrayBuffer(4)),new i,new i,new i,new i,new i,new i,new i;var E={name:"sha3",data:"AGFzbQEAAAABFARgAAF/YAF/AGACf38AYAN/f38AAwgHAAEBAgEAAwUEAQECAgYOAn8BQZCNBQt/AEGACAsHcAgGbWVtb3J5AgAOSGFzaF9HZXRCdWZmZXIAAAlIYXNoX0luaXQAAQtIYXNoX1VwZGF0ZQACCkhhc2hfRmluYWwABA1IYXNoX0dldFN0YXRlAAUOSGFzaF9DYWxjdWxhdGUABgpTVEFURV9TSVpFAwEKqBwHBQBBgAoL1wMAQQBCADcDgI0BQQBCADcD+IwBQQBCADcD8IwBQQBCADcD6IwBQQBCADcD4IwBQQBCADcD2IwBQQBCADcD0IwBQQBCADcDyIwBQQBCADcDwIwBQQBCADcDuIwBQQBCADcDsIwBQQBCADcDqIwBQQBCADcDoIwBQQBCADcDmIwBQQBCADcDkIwBQQBCADcDiIwBQQBCADcDgIwBQQBCADcD+IsBQQBCADcD8IsBQQBCADcD6IsBQQBCADcD4IsBQQBCADcD2IsBQQBCADcD0IsBQQBCADcDyIsBQQBCADcDwIsBQQBCADcDuIsBQQBCADcDsIsBQQBCADcDqIsBQQBCADcDoIsBQQBCADcDmIsBQQBCADcDkIsBQQBCADcDiIsBQQBCADcDgIsBQQBCADcD+IoBQQBCADcD8IoBQQBCADcD6IoBQQBCADcD4IoBQQBCADcD2IoBQQBCADcD0IoBQQBCADcDyIoBQQBCADcDwIoBQQBCADcDuIoBQQBCADcDsIoBQQBCADcDqIoBQQBCADcDoIoBQQBCADcDmIoBQQBCADcDkIoBQQBCADcDiIoBQQBCADcDgIoBQQBBwAwgAEEBdGtBA3Y2AoyNAUEAQQA2AoiNAQuMAwEIfwJAQQAoAoiNASIBQQBIDQBBACABIABqQQAoAoyNASICcDYCiI0BAkACQCABDQBBgAohAwwBCwJAIAIgAWsiBCAAIAQgAEkbIgNFDQAgA0EDcSEFQQAhBgJAIANBBEkNACABQYCKAWohByADQXxxIQhBACEGA0AgByAGaiIDQcgBaiAGQYAKai0AADoAACADQckBaiAGQYEKai0AADoAACADQcoBaiAGQYIKai0AADoAACADQcsBaiAGQYMKai0AADoAACAIIAZBBGoiBkcNAAsLIAVFDQAgAUHIiwFqIQMDQCADIAZqIAZBgApqLQAAOgAAIAZBAWohBiAFQX9qIgUNAAsLIAQgAEsNAUHIiwEgAhADIAAgBGshACAEQYAKaiEDCwJAIAAgAkkNAANAIAMgAhADIAMgAmohAyAAIAJrIgAgAk8NAAsLIABFDQBBACECQcgBIQYDQCAGQYCKAWogAyAGakG4fmotAAA6AAAgBkEBaiEGIAAgAkEBaiICQf8BcUsNAAsLC+QLAS1+IAApA0AhAkEAKQPAigEhAyAAKQM4IQRBACkDuIoBIQUgACkDMCEGQQApA7CKASEHIAApAyghCEEAKQOoigEhCSAAKQMgIQpBACkDoIoBIQsgACkDGCEMQQApA5iKASENIAApAxAhDkEAKQOQigEhDyAAKQMIIRBBACkDiIoBIREgACkDACESQQApA4CKASETQQApA8iKASEUAkACQCABQcgASw0AQQApA9CKASEVQQApA+CKASEWQQApA9iKASEXDAELQQApA+CKASAAKQNghSEWQQApA9iKASAAKQNYhSEXQQApA9CKASAAKQNQhSEVIBQgACkDSIUhFCABQekASQ0AQQBBACkD6IoBIAApA2iFNwPoigFBAEEAKQPwigEgACkDcIU3A/CKAUEAQQApA/iKASAAKQN4hTcD+IoBQQBBACkDgIsBIAApA4ABhTcDgIsBIAFBiQFJDQBBAEEAKQOIiwEgACkDiAGFNwOIiwELIAMgAoUhGCAFIASFIRkgByAGhSEHIAkgCIUhCCALIAqFIRogDSAMhSEJIA8gDoUhCiARIBCFIQsgEyAShSEMQQApA7iLASESQQApA5CLASETQQApA+iKASEbQQApA6CLASEcQQApA/iKASENQQApA7CLASEdQQApA4iLASEOQQApA8CLASEPQQApA5iLASEeQQApA/CKASEQQQApA6iLASERQQApA4CLASEfQcB+IQADQCAaIAcgC4UgF4UgH4UgEYVCAYmFIBSFIBCFIB6FIA+FIQIgDCAZIAqFIBaFIA6FIB2FQgGJhSAIhSAVhSANhSAchSIDIAeFISAgCSAIIAyFIBWFIA2FIByFQgGJhSAYhSAbhSAThSAShSIEIA+FISEgGCAKIBQgGoUgEIUgHoUgD4VCAYmFIBmFIBaFIA6FIB2FIgWFQjeJIiIgCyAYIAmFIBuFIBOFIBKFQgGJhSAHhSAXhSAfhSARhSIGIAqFQj6JIiNCf4WDIAMgEYVCAokiJIUhDyANIAKFQimJIiUgBCAQhUIniSImQn+FgyAihSERIBIgBYVCOIkiEiAGIA6FQg+JIidCf4WDIAMgF4VCCokiKIUhDiAEIBqFQhuJIikgKCAIIAKFQiSJIipCf4WDhSENIAYgGYVCBokiKyADIAuFQgGJIixCf4WDIBwgAoVCEokiLYUhECArIAQgHoVCCIkiLiAbIAWFQhmJIhtCf4WDhSEXIAYgHYVCPYkiGSAEIBSFQhSJIgQgCSAFhUIciSIIQn+Fg4UhFCAIIBlCf4WDIAMgH4VCLYkiA4UhGCAZIANCf4WDIBUgAoVCA4kiCYUhGSAEIAMgCUJ/hYOFIQcgCSAEQn+FgyAIhSEIIAwgAoUiAiAhQg6JIgNCf4WDIBMgBYVCFYkiBIUhCSAGIBaFQiuJIgUgAyAEQn+Fg4UhCiAEIAVCf4WDICBCLIkiBIUhCyAAQdAJaikDACAFIARCf4WDhSAChSEMICcgKEJ/hYMgKoUiBSEfIAMgBCACQn+Fg4UiAiEaICogKUJ/hYMgEoUiAyEeIC0gLkJ/hYMgG4UiBCEWICYgJCAlQn+Fg4UiBiEdIBsgK0J/hYMgLIUiKCEVICMgJiAiQn+Fg4UiIiEcIC4gLCAtQn+Fg4UiJiEbICcgKSASQn+Fg4UiJyETICMgJEJ/hYMgJYUiIyESIABBCGoiAA0AC0EAIBE3A6iLAUEAIAU3A4CLAUEAIBc3A9iKAUEAIAc3A7CKAUEAIAs3A4iKAUEAIA83A8CLAUEAIAM3A5iLAUEAIBA3A/CKAUEAIBQ3A8iKAUEAIAI3A6CKAUEAIAY3A7CLAUEAIA43A4iLAUEAIAQ3A+CKAUEAIBk3A7iKAUEAIAo3A5CKAUEAICI3A6CLAUEAIA03A/iKAUEAICg3A9CKAUEAIAg3A6iKAUEAIAw3A4CKAUEAICM3A7iLAUEAICc3A5CLAUEAICY3A+iKAUEAIBg3A8CKAUEAIAk3A5iKAQv4AgEFf0HkAEEAKAKMjQEiAUEBdmshAgJAQQAoAoiNASIDQQBIDQAgASEEAkAgASADRg0AIANByIsBaiEFQQAhAwNAIAUgA2pBADoAACADQQFqIgMgAUEAKAKIjQEiBGtJDQALCyAEQciLAWoiAyADLQAAIAByOgAAIAFBx4sBaiIDIAMtAABBgAFyOgAAQciLASABEANBAEGAgICAeDYCiI0BCwJAIAJBBEkNACACQQJ2IgNBA3EhBUEAIQQCQCADQX9qQQNJDQAgA0H8////A3EhAUEAIQNBACEEA0AgA0GACmogA0GAigFqKAIANgIAIANBhApqIANBhIoBaigCADYCACADQYgKaiADQYiKAWooAgA2AgAgA0GMCmogA0GMigFqKAIANgIAIANBEGohAyABIARBBGoiBEcNAAsLIAVFDQAgBUECdCEBIARBAnQhAwNAIANBgApqIANBgIoBaigCADYCACADQQRqIQMgAUF8aiIBDQALCwsGAEGAigEL0QYBA39BAEIANwOAjQFBAEIANwP4jAFBAEIANwPwjAFBAEIANwPojAFBAEIANwPgjAFBAEIANwPYjAFBAEIANwPQjAFBAEIANwPIjAFBAEIANwPAjAFBAEIANwO4jAFBAEIANwOwjAFBAEIANwOojAFBAEIANwOgjAFBAEIANwOYjAFBAEIANwOQjAFBAEIANwOIjAFBAEIANwOAjAFBAEIANwP4iwFBAEIANwPwiwFBAEIANwPoiwFBAEIANwPgiwFBAEIANwPYiwFBAEIANwPQiwFBAEIANwPIiwFBAEIANwPAiwFBAEIANwO4iwFBAEIANwOwiwFBAEIANwOoiwFBAEIANwOgiwFBAEIANwOYiwFBAEIANwOQiwFBAEIANwOIiwFBAEIANwOAiwFBAEIANwP4igFBAEIANwPwigFBAEIANwPoigFBAEIANwPgigFBAEIANwPYigFBAEIANwPQigFBAEIANwPIigFBAEIANwPAigFBAEIANwO4igFBAEIANwOwigFBAEIANwOoigFBAEIANwOgigFBAEIANwOYigFBAEIANwOQigFBAEIANwOIigFBAEIANwOAigFBAEHADCABQQF0a0EDdjYCjI0BQQBBADYCiI0BIAAQAkHkAEEAKAKMjQEiAEEBdmshAwJAQQAoAoiNASIBQQBIDQAgACEEAkAgACABRg0AIAFByIsBaiEFQQAhAQNAIAUgAWpBADoAACABQQFqIgEgAEEAKAKIjQEiBGtJDQALCyAEQciLAWoiASABLQAAIAJyOgAAIABBx4sBaiIBIAEtAABBgAFyOgAAQciLASAAEANBAEGAgICAeDYCiI0BCwJAIANBBEkNACADQQJ2IgFBA3EhBUEAIQQCQCABQX9qQQNJDQAgAUH8////A3EhAEEAIQFBACEEA0AgAUGACmogAUGAigFqKAIANgIAIAFBhApqIAFBhIoBaigCADYCACABQYgKaiABQYiKAWooAgA2AgAgAUGMCmogAUGMigFqKAIANgIAIAFBEGohASAAIARBBGoiBEcNAAsLIAVFDQAgBUECdCEAIARBAnQhAQNAIAFBgApqIAFBgIoBaigCADYCACABQQRqIQEgAEF8aiIADQALCwsL2AEBAEGACAvQAZABAAAAAAAAAAAAAAAAAAABAAAAAAAAAIKAAAAAAAAAioAAAAAAAIAAgACAAAAAgIuAAAAAAAAAAQAAgAAAAACBgACAAAAAgAmAAAAAAACAigAAAAAAAACIAAAAAAAAAAmAAIAAAAAACgAAgAAAAACLgACAAAAAAIsAAAAAAACAiYAAAAAAAIADgAAAAAAAgAKAAAAAAACAgAAAAAAAAIAKgAAAAAAAAAoAAIAAAACAgYAAgAAAAICAgAAAAAAAgAEAAIAAAAAACIAAgAAAAIA=",hash:"f2f6f5b2"},f=new i,d=null;function p(A){return[224,256,384,512].includes(A)?null:new Error("Invalid variant! Valid values: 224, 256, 384, 512")}new i,new i,new i,new i,new i,new i,new i,new ArrayBuffer(8),new i,new ArrayBuffer(8),new i,new ArrayBuffer(8),new i,new i,new i,A.$hashWasm={sha3:function(A,t=512){if(p(t))return Promise.reject(p(t));const i=t/8;if(null===d||d.hashLength!==i)return function(A,t,i){return e(this,void 0,void 0,(function*(){const e=yield A.lock(),r=yield C(t,i);return e(),r}))}(f,E,i).then((e=>(d=e).calculate(A,t,6)));try{const e=d.calculate(A,t,6);return Promise.resolve(e)}catch(A){return Promise.reject(A)}}}})(),(()=>{const{$utils:e}=A;e.createPromise=()=>{let A=null,e=null;const t=new Promise(((t,i)=>{A=t,e=i}));return Object.defineProperty(t,"resolve",{get:()=>A}),Object.defineProperty(t,"reject",{get:()=>e}),t}})(),(()=>{const{$utils:e}=A;e.is={null:A=>null===A,defined:A=>void 0!==A,undefined:A=>void 0===A,nil:A=>null==A,boolean:A=>"boolean"==typeof A,number:A=>"number"==typeof A,string:A=>"string"==typeof A,symbol:A=>"symbol"==typeof A,function:A=>"function"==typeof A,map:A=>A instanceof Map,set:A=>A instanceof Set,url:A=>A instanceof URL,blob:A=>A instanceof Blob,file:A=>A instanceof File,error:A=>A instanceof Error,regexp:A=>A instanceof RegExp,array:A=>Array.isArray(A),object:A=>"[object Object]"===Object.prototype.toString.call(A),nan:A=>Number.isNaN(A),nonPrimitive:A=>e.is.object(A)||e.is.array(A),numeric:A=>!e.is.nan(Number(A)),empty:A=>!!e.is.nil(A)||(e.is.array(A)?0===A.length:e.is.object(A)?0===Object.keys(A).length:!!e.is.string(A)&&0===A.trim().length)}})(),(()=>{const{$utils:e,$bus:t}=A;e.objectUrl={create(A,i=!1){if(!URL.createObjectURL)return t.send("utils.objectUrl.create",A,i);const r=URL.createObjectURL(A);if(i){const A=e.is.number(i)?i:6e4;setTimeout((()=>URL.revokeObjectURL(r)),A)}return r},revoke(A){if(!URL.revokeObjectURL)return t.send("utils.objectUrl.revoke",A);URL.revokeObjectURL(A)}}})(),(()=>{const{$utils:e}=A;e.pickRandom=A=>A[Math.floor(Math.random()*A.length)]})(),Array.prototype.toReversed&&(Array.prototype.toReversed=function(){return[...this].reverse()}),Array.prototype.at||(Array.prototype.at=function(A){return this[A>=0?A:this.length+A]}),Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(A,e){for(let t=this.length-1;t>=0;t--)if(A.call(e,this[t],t,this))return t;return-1}),(()=>{const{$utils:e}=A;e.sleep=async A=>new Promise((e=>{setTimeout(e,A)}))})(),(()=>{const{$utils:e}=A;e.waitFor=async(A,{interval:t=100,timeout:i=6e4}={})=>{if(i<=0)throw new Error("$utils.waitFor: timeout exceeded");const r=Date.now(),s=await A();if(s)return s;await e.sleep(t);const n=Date.now()-r;return e.waitFor(A,{interval:t,timeout:i-n})}})(),(()=>{const{$ai:e,$utils:t,$bus:i,$hashWasm:r}=A;e.arkoseController={init(){this._arkose=null,this._setupPromise=null,this._firstTimeFetchToken=!0,this._fetchTokenPromise=t.createPromise(),i.on("ai.retrieveArkoseToken",this._retrieveArkoseToken,this),i.on("ai.generateProofToken",this._generateProofToken,this)},async _retrieveArkoseToken({dx:A,config:e,accessToken:i}){await this._ensureSetup(e,i),this._arkose.setConfig({[e.dataKey]:{[e.blobKey]:A}}),this._firstTimeFetchToken?(this._arkose.run(),this._firstTimeFetchToken=!1):(this._fetchTokenPromise=t.createPromise(),this._arkose.reset());const r=setTimeout((()=>this._fetchTokenPromise.reject("Token fetching timed out")),e.tokenFetchTimeout),s=await this._fetchTokenPromise;return clearTimeout(r),s},async _generateProofToken({seed:A,difficulty:e,scripts:i,dpl:s}){const n=A=>{const e=JSON.stringify(A);return btoa(String.fromCharCode(...(new TextEncoder).encode(e)))},o=performance.now(),a=Object.keys(Object.getPrototypeOf(navigator)),c=t.pickRandom(a),h=[navigator.hardwareConcurrency+screen.width+screen.height,(new Date).toString(),performance.memory.jsHeapSizeLimit,Math.random(),navigator.userAgent,t.pickRandom(i),s,navigator.language,navigator.languages.join(","),Math.random(),`${c}-${navigator[c]}`,t.pickRandom(Object.keys(document)),t.pickRandom(Object.keys(window)),performance.now(),crypto.randomUUID()];for(let i=1;i<1e5;i++){i%1e3==0&&await t.sleep(150),h[3]=i,h[9]=Math.round(performance.now()-o);const s=n(h);if((await r.sha3(`${A}${s}`)).substring(0,e.length)<=e)return s}return null},async _ensureSetup(A,e){if(this._setupPromise)return this._setupPromise;if(this._setupPromise=t.createPromise(),this._patchArkoseIframe(A),window.useArkoseSetupEnforcement=async e=>{e.setConfig({...A.params,[A.selectorKey]:"#challenge",[A.onErrorKey]:A=>{this._fetchTokenPromise.reject(A)},[A.onCompletedKey]:e=>{this._fetchTokenPromise.resolve(e[A.resultTokenKey])}}),this._arkose=e},!document.getElementById("challenge")){const A=document.createElement("div");A.id="challenge",document.body.appendChild(A)}const i=document.createElement("script"),r=A.script;Object.entries(r).forEach((([A,e])=>i.setAttribute(A,e))),document.head.appendChild(i),await new Promise(((e,t)=>{const r=setTimeout((()=>{t("Script loading timed out")}),A.scriptLoadTimeout);i.onload=()=>{clearTimeout(r),i.setAttribute("data-status","loaded"),e()},i.onerror=()=>{clearTimeout(r),i.setAttribute("data-status","failed"),t("Script loading failed")}})),this._setupPromise.resolve()},_patchArkoseIframe(A){const e=HTMLElement.prototype.appendChild;HTMLElement.prototype.appendChild=function(...i){const r=i[0];return r&&t.is.string(r.tagName)&&"iframe"===r.tagName.toLowerCase()&&r.src.startsWith(A.iframeUrl)&&r.setAttribute("name",`ae:${JSON.stringify(A)}`),e.call(this,...i)}}}})(),(()=>{const{$ai:e}=A;e.controller={init(){e.arkoseController.init()}}})(),(()=>{const{$bus:e,$env:t,$utils:i}=A;e.controller={async init(){e.on=this.on.bind(this),e.off=this.off.bind(this),e.once=this.once.bind(this),e.send=this._wrapThrowIfError(this.send),e.call=this._wrapThrowIfError(this.call),e.poll=this.poll.bind(this),e.getTabId=this.getTabId.bind(this),this._locus=t.getLocus(),this._serialize=this._serialize.bind(this),this._handlers={},this._is("pp")?(this._setupPp(),this._tabId=await e.getTabId()):this._is("bg")?(this._blobs={},this._channel=new BroadcastChannel("bus.channel"),this._setupBg()):this._is("cs")?await this._setupCs():this._is("nj")?this._setupNj():this._is("os")?(e.setIframe=A=>this._iframe=A,this._iframe=null,this._channel=new BroadcastChannel("bus.channel"),this._setupOs()):this._is("oi")&&this._setupOi()},on(A,e,t=null){this._on(A,null,e,t)},off(A,e=null){this._off(A,null,e)},once(A,e){const t=async(...i)=>(this.off(A,t),await e(...i));this.on(A,t)},async send(A,...t){if(i.is.numeric(A)){const e=Number(A);return A=t[0],t=t.slice(1),await this._pick([this._sendToCs(e,A,...t),this._sendToExt(e,A,...t)])}if(this._is("pp"))return await this._sendToExt(A,...t);if(this._is("nj"))return await this._sendToPage(A,...t);if(this._is("oi"))return await this._sendToParent(A,...t);if(this._is("bg","cs","os"))return await this._pick([this._sendToExt(A,...t),this._callHandlers({name:A,args:t},(A=>A.proxy))]);if(this._is("fg")){if("store.actions"===A)return;if("idb.change"===A)return;e.log(A,...t)}},async call(A,...e){return this._callHandlers({name:A,args:e},(A=>!A.proxy))},async poll(A,...e){return await i.waitFor((()=>this.send(A,...e)))},async getTabId(){if(this._is("bg"))return null;if(this._is("pp")){const A=new URL(location.href).searchParams.get("tabId");if(A)return Number(A)}const{tabId:A}=await this.send("bus.getTabData");return A},_on(A,e,t,i=null){this._handlers[A]||(this._handlers[A]=[]),this._is("cs","nj","oi")&&0===this._handlers[A].length&&this._sendToProxier("bus.proxy",A,!0);const r={fn:t,name:A};e&&(r.proxy=e),i&&(r.this=i),this._handlers[A].push(r)},_off(A,e=null,t=null){this._handlers[A]&&(this._handlers[A]=this._handlers[A].filter((A=>{const i=!t||t===A.fn,r=e===(A.proxy||null);return!i||!r})),0===this._handlers[A].length&&(delete this._handlers[A],this._is("cs","nj","oi")&&this._sendToProxier("bus.proxy",A,!1)))},_setupPp(){},_setupBg(){},async _setupCs(){},_setupNj(){},_setupOs(){},_setupOi(){window.addEventListener("message",(async({data:A})=>{if(!this._isBusMsg(A))return;const e=await this._callHandlers(A);window.parent.postMessage({resId:A.reqId,result:e},"*")}))},async _sendToExt(A,...t){let r=null;i.is.numeric(A)&&(r=Number(A),A=t[0],t=t.slice(1));const s=this._serialize(t),n=this._createBusMsg({name:A,argsStr:s,target:r}),o=await new Promise((A=>{try{chrome.runtime.sendMessage(n,(e=>{chrome.runtime.lastError?A(null):A(e)}))}catch(t){if("Extension context invalidated."===t.message)return;e.error(t),A(null)}}));return await this._deserialize(o)},async _sendToCs(A,e,...t){if(!chrome.tabs?.sendMessage)return await this.send("bus.sendToCs",A,e,...t);const i=this._serialize(t),r=this._createBusMsg({name:e,argsStr:i,target:"cs"}),s=await new Promise((e=>{chrome.tabs.sendMessage(A,r,(A=>{chrome.runtime.lastError?e(null):e(A)}))}));return await this._deserialize(s)},async _sendToPage(A,...e){const t=this._generateId(),i=this._createBusMsg({name:A,args:e,reqId:t,locus:this._locus});return window.postMessage(i,"*"),await this._waitForResponseMessage(t)},async _sendToIframe(A,...e){if(!this._iframe)return null;const t=this._generateId(),i=this._createBusMsg({name:A,args:e,reqId:t});return this._iframe.contentWindow.postMessage(i,"*"),await this._waitForResponseMessage(t)},async _sendToParent(A,...e){const t=this._generateId(),i=this._createBusMsg({name:A,args:e,reqId:t});return parent.postMessage(i,"*"),await this._waitForResponseMessage(t)},async _sendToProxier(A,...e){return this._is("cs")?await this._sendToExt(A,...e):this._is("nj")?await this._sendToPage(A,...e):this._is("oi")?await this._sendToParent(A,...e):void 0},_waitForResponseMessage:async A=>await new Promise((e=>{const t=({data:i})=>{!(!i||i.resId!==A)&&(window.removeEventListener("message",t),e(i.result))};window.addEventListener("message",t)})),_callHandlers({name:A,args:t,argsStr:i},r=null){let s=this._handlers[A];return s?(r&&(s=s.filter(r)),0===s.length?null:new Promise((async A=>{i&&(t=await this._deserialize(i));A(await this._pick(s.map((async A=>{try{return await A.fn.call(A.this,...t)}catch(t){return e.error(`failed to handle "${A.name}".`,t),t}}))))}))):null},_removeProxyHandlers(A){Object.keys(this._handlers).forEach((e=>{this._handlers[e]=this._handlers[e].filter((e=>e.proxy!==A)),0===this._handlers[e].length&&delete this._handlers[e]}))},_serialize(A){return i.is.nil(A)?null:JSON.stringify(A,((A,e)=>{if(i.is.blob(e)){if(this._is("bg")){const A=this._generateId();return this._blobs[A]=e,`bus.blob.${A}`}return`bus.blob.${i.objectUrl.create(e,!0)}`}return i.is.error(e)?`bus.error.${e.message}`:e}))},async _deserialize(A){if(!i.is.string(A))return null;const e=new Map,t=JSON.parse(A,((A,t)=>{const r=i.is.string(t);return r&&t.startsWith("bus.blob.")?(e.set(t,t.slice("bus.blob.".length)),t):r&&t.startsWith("bus.error.")?new Error(t.slice("bus.error.".length)):t}));return await Promise.all([...e.keys()].map((async A=>{let t;const i=e.get(A);t=i.startsWith("blob:")?i:await this._sendToExt("bus.blobIdToObjectUrl",i);const r=await fetch(t).then((A=>A.blob()));e.set(A,r)}))),this._applyBlobs(t,e)},_applyBlobs(A,e){if(e.has(A))return e.get(A);if(i.is.array(A)||i.is.object(A))for(const t in A)A[t]=this._applyBlobs(A[t],e);return A},async _blobIdToObjectUrl(A){},async _blobToObjectUrl(A){},_is(...A){return A.includes(this._locus)},_isBusMsg:e=>e&&e.$bus&&e.appName===A.name,_createBusMsg:e=>({$bus:!0,appName:A.name,...e}),_generateId:()=>`bus-${Date.now()}-${Math.random().toString(36).slice(2)}`,_wrapThrowIfError(A){return async(...e)=>{const t=await A.call(this,...e);if(i.is.error(t))throw t;return t}},_pick:async(A=[])=>0===A.length?null:await new Promise((e=>{let t=0;A.forEach((async r=>{const s=await r;return i.is.nil(s)?t===A.length-1?e(null):void t++:e(s)}))}))}})(),(()=>{const{$env:e}=A;e.getLocus=()=>{const{protocol:A,host:e,pathname:t,href:i}=location;return"https://harpa.ai/oi"===i||"http://localhost:3000/oi"===i||"http://localhost:3010/oi"===i?"oi":"chrome-extension:"!==A&&chrome?.runtime?.getURL?"cs":"localhost:3050"===e?"fg":"chrome-extension:"!==A?"nj":"/harpa.html"===t?"pp":"/offscreen.html"===t?"os":"bg"}})(),(()=>{const{$startup:e,$bus:t,$ai:i}=A;e.controller={async init(){await t.controller.init(),await i.controller.init(),t.on("startup.oiReady",(()=>!0)),e.logDev("oi ready")}},e.controller.init()})()})();